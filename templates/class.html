<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>강의실</title>
    <!-- Required meta tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.class-list').empty()
            show_class()
        });



        function openClose() {
            // add-box의 display 값이 block 이면(= 눈에 보이면)
            if ($(".add-box").css("display") == "block") {
                // add-box를 가리고
                $(".add-box").hide();
            } else {
                // 아니면(눈에 보이지 않으면) post-box를 펴라
                $(".add-box").show();
            }
        }

        function show_class(){
            $.ajax({
                type: "GET",
                url: "/class",
                data: {},
                success: function (response) { // 서버에서 준 결과를 response라는 변수에 담음
                    if (response['result'] == 'success') {
                        let classname= response['classname'] //list
                        let classurl= response['classurl']  //dict

                        for(let i=0; i<classname.length; i++){
                            let name=classname[i]
                            let url=classurl[name]
                            let tempHtml=`<div class="card w-1000">
                                            <div class="card-body">
                                                <h5 class="card-title">${name}</h5>
                                                <a class="btn btn-primary" href=${url} role="button" target="_blank">강의보기</a>
                                                <button class="btn btn-primary" type="submit" onclick="delete_class('${name}')">삭제하기</button>
                                            </div>
                                          </div>`

                            $('.class-list').append(tempHtml)
                        }
                    }
                }
            })

        }

        function add() {
            let new_class = $('.new-class').val()
            let new_url = $('.new-url').val()


            $.ajax({
                type: "POST",
                url: "/class",
                data: {
                    'class_give': new_class,
                    'url_give': new_url
                },
                success: function (response) { // 서버에서 준 결과를 response라는 변수에 담음
                    if (response['result'] == 'success') {
                        alert(response['msg'])
                        location.reload()
                    }
                }
            })

        }

        function delete_class(classname){
            $.ajax({
                type: "POST",
                url: "/class2",
                data: {
                    'classname_give': classname,
                },
                success: function (response) { // 서버에서 준 결과를 response라는 변수에 담음
                    if (response['result'] == 'success') {
                        alert(response['msg'])
                        location.reload()
                    }
                }
            })

        }




    </script>
    <style type="text/css">
        .title {
            width: 1000px;
            height: 100px;
            border-style: solid;
            border-color: black;
            text-align: center;
            margin: 40px auto;
            padding-top: 20px;
        }

        .add-bt {
            margin: 50px auto;
            width: 100px;
        }

        .class-list {
            margin: 40px auto;
            width: 750px;
        }

        .add-box {
            width: 500px;
            height: 300px;
            border-style: solid;
            border-color: black;
            text-align: center;
            margin: 40px auto;
            padding-top: 70px;

        }


    </style>
</head>
<body>
<div class="title">
    <h1>{{realuser}}님의 강의실</h1>
</div>
<div class="add-bt">
    <button onclick="openClose()">강의추가</button>
</div>
<div class="add-box" style="display: none">
    <h4>
        강의추가하기
    </h4>
    <p>
        강의이름: <input class="new-class">
    </p>
    <p>
        webex URL: <input class="new-url">
    </p>
    <p>
        <button onclick="add()">추가하기</button>
    </p>
</div>
<div class="class-list">

</div>
</body>
</html>